<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>استبيان: Are You a Zombie؟</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3f51b5;
            --primary-dark: #303f9f;
            --primary-light: #c5cae9;
            --accent: #ff4081;
            --text-primary: #212121;
            --text-secondary: #757575;
            --light: #f5f5f5;
            --dark: #212121;
            --divider: #e0e0e0;
            --green: #4caf50;
            --blue: #2196f3;
            --purple: #9c27b0;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'IBM Plex Sans Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(to bottom right, #f5f7fa, #e8eaf6);
            direction: rtl;
            min-height: 100vh;
            padding: 0;
            font-size: 15px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .header {
            background: linear-gradient(to right, var(--primary-dark), var(--primary));
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 12px;
        }

        .header-badge {
            background-color: var(--accent);
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 8px;
            font-size: 14px;
        }

        .page {
            display: none;
            padding: 25px;
        }

        .active {
            display: block;
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin: 8px 4px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
            background-color: var(--primary-dark);
        }

        .btn i {
            margin-left: 6px;
        }

        .btn-accent {
            background-color: var(--accent);
        }

        .btn-accent:hover {
            background-color: #e91e63;
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary-light);
        }

        .form-group {
            margin-bottom: 18px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--divider);
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
            font-family: 'IBM Plex Sans Arabic', sans-serif;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(63, 81, 181, 0.2);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .progress-container {
            margin: 20px 0;
            background-color: #f1f1f1;
            border-radius: 10px;
            overflow: hidden;
            height: 10px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--green), var(--blue));
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            margin-bottom: 18px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .survey-section {
            margin-bottom: 25px;
            padding: 18px;
            border: 1px solid var(--divider);
            border-radius: 10px;
            background-color: white;
        }

        .question {
            margin-bottom: 18px;
            padding-bottom: 12px;
            border-bottom: 1px dashed var(--divider);
        }

        .question:last-child {
            border-bottom: none;
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            font-size: 15px;
        }

        .rating {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .rating label {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            margin: 4px;
            flex: 1;
            min-width: 70px;
            padding: 8px;
            border-radius: 8px;
            background: white;
            border: 2px solid var(--divider);
            transition: all 0.2s;
        }

        .rating label:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }

        .rating input {
            width: auto;
            margin-top: 4px;
        }

        textarea {
            min-height: 90px;
            resize: vertical;
            font-size: 14px;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 18px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--divider);
        }

        .card-title {
            font-size: 19px;
            color: var(--primary-dark);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-light);
            font-weight: 700;
        }

        .intro-content {
            line-height: 1.7;
        }

        .intro-content h3 {
            color: var(--primary-dark);
            margin: 18px 0 8px;
            font-size: 18px;
        }

        .intro-content ul {
            padding-right: 18px;
            margin: 12px 0;
        }

        .intro-content li {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 18px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 18px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--divider);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin: 8px 0;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .admin-only {
            display: none;
        }

        .login-form {
            max-width: 480px;
            margin: 0 auto;
        }

        .response-item {
            border-right: 4px solid var(--primary);
            margin-bottom: 18px;
            background: white;
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--divider);
        }

        .response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .response-title {
            font-size: 16px;
            color: var(--text-primary);
            font-weight: 600;
        }

        .response-details {
            margin-right: 18px;
            font-size: 14px;
        }

        .details-toggle {
            cursor: pointer;
            color: var(--primary);
            font-weight: 600;
            font-size: 13px;
        }

        .privacy-note {
            background-color: #e8f5e9;
            border-radius: 8px;
            padding: 12px;
            margin: 18px 0;
            border-right: 4px solid var(--green);
            font-size: 13px;
        }

        .auto-save-indicator {
            position: fixed;
            bottom: 18px;
            left: 18px;
            background-color: var(--green);
            color: white;
            padding: 8px 12px;
            border-radius: 30px;
            font-size: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 0;
                margin-top: 0;
                margin-bottom: 0;
            }
            
            .rating {
                flex-wrap: wrap;
            }
            
            .rating label {
                margin: 4px;
                flex: 1 0 38%;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .header p {
                font-size: 15px;
            }
            
            .page {
                padding: 18px;
            }
        }

        .welcome-section {
            text-align: center;
            padding: 35px 18px;
        }

        .welcome-icon {
            font-size: 50px;
            color: var(--primary);
            margin-bottom: 18px;
        }

        .welcome-text {
            font-size: 16px;
            line-height: 1.7;
            margin-bottom: 25px;
            color: var(--text-secondary);
        }

        .feature-list {
            text-align: right;
            margin: 25px 0;
            padding-right: 18px;
        }

        .feature-list li {
            margin-bottom: 12px;
            list-style-type: none;
            position: relative;
            padding-right: 25px;
            font-size: 14px;
        }

        .feature-list li:before {
            content: '✓';
            position: absolute;
            right: 0;
            top: 0;
            color: var(--green);
            font-weight: bold;
            font-size: 16px;
        }

        .rating-table {
            width: 100%;
            border-collapse: collapse;
            margin: 18px 0;
            font-size: 14px;
        }

        .rating-table th, .rating-table td {
            border: 1px solid var(--divider);
            padding: 10px;
            text-align: center;
        }

        .rating-table th {
            background-color: var(--primary-light);
            color: var(--primary-dark);
            font-weight: 600;
        }

        .rating-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .research-title {
            color: var(--primary-dark);
            font-weight: 700;
            font-size: 20px;
            margin: 22px 0 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-light);
        }

        .info-section {
            background-color: #f5f5f5;
            padding: 18px;
            border-radius: 10px;
            margin: 18px 0;
            border-right: 4px solid var(--purple);
            font-size: 14px;
        }

        .info-section h3 {
            color: var(--purple);
            margin-bottom: 12px;
            font-size: 18px;
        }

        small {
            font-size: 12px;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>استبيان: Are You a Zombie؟</h1>
            <p>(اختبار الوعي والاستقلالية الفكرية)</p>
            <div class="header-badge">دراسة بحثية</div>
        </div>

        <!-- صفحة البداية -->
        <div id="startPage" class="page active">
            <div class="welcome-section">
                <div class="welcome-icon">
                    <i class="fas fa-brain"></i>
                </div>
                
                <div class="research-title">
                    دراسة تحليلية للعوامل المؤثرة في سلوك الأفراد واتخاذ القرار: بين الاقتداء والاستقلالية
                </div>
                
                <div class="info-section">
                    <h3><i class="fas fa-users"></i> المشاركة</h3>
                    <p>جمع بيانات من مختلف الأماكن والبيئات والأعمار</p>
                </div>
                
                <div class="info-section">
                    <h3><i class="fas fa-bullseye"></i> العمل</h3>
                    <p>قياس استقلالية التفكير مقابل التأثر بالبيئة المحيطة</p>
                </div>
                
                <h3>دليل الإجابة على الأسئلة</h3>
                <p>سيتم استخدام مقياس من 1 إلى 5 حيث:</p>
                
                <table class="rating-table">
                    <tr>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4</th>
                        <th>5</th>
                    </tr>
                    <tr>
                        <td>أوافق بشدة</td>
                        <td>أوافق</td>
                        <td>محايد</td>
                        <td>لا أوافق</td>
                        <td>لا أوافق بشدة</td>
                    </tr>
                </table>
                
                <div class="card">
                    <h3>معلومات مهمة عن الاستبيان</h3>
                    <p>
                        في عصرنا الذي يتسم بالتغير السريع وتدفق المعلومات غير المسبوق، أصبح الفرد معرضاً لمؤثرات متعددة تهدف إلى تشكيل سلوكه وتوجهاته وقراراته. 
                        تهدف هذه الدراسة إلى تحليل العوامل التي تؤثر على عملية اتخاذ القرارات للأفراد، وقياس مدى استقلالية التفكير مقابل التأثر بالبيئة المحيطة والمؤثرات الخارجية.
                    </p>
                </div>
                
                <div class="privacy-note">
                    <i class="fas fa-shield-alt"></i> جميع البيانات المجمعة سيتم استخدامها لأغراض البحث العلمي فقط وستظل سرية.
                </div>
                
                <button class="btn btn-accent" onclick="showPage('namePage')">
                    <i class="fas fa-play"></i> إبدأ الاستبيان
                </button>
                <button class="btn btn-outline" onclick="showPage('adminLoginPage')">
                    <i class="fas fa-cog"></i> الدخول كمسؤول
                </button>
            </div>
        </div>

        <!-- صفحة المعلومات الأساسية -->
        <div id="namePage" class="page">
            <h2>المعلومات الأساسية</h2>
            
            <div class="card">
                <form id="basicInfoForm">
                    <div class="form-group">
                        <label for="gender"><i class="fas fa-venus-mars"></i> الجنس:</label>
                        <select id="gender" name="gender" required>
                            <option value="">-- اختر --</option>
                            <option value="ذكر">ذكر</option>
                            <option value="أنثى">أنثى</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="age"><i class="fas fa-birthday-cake"></i> الفئة العمرية:</label>
                        <select id="age" name="age" required>
                            <option value="">-- اختر --</option>
                            <option value="أقل من 18 سنة">أقل من 18 سنة</option>
                            <option value="18-25 سنة">18-25 سنة</option>
                            <option value="26-35 سنة">26-35 سنة</option>
                            <option value="36-45 سنة">36-45 سنة</option>
                            <option value="46 سنة فأكثر">46 سنة فأكثر</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="education"><i class="fas fa-graduation-cap"></i> المستوى التعليمي:</label>
                        <select id="education" name="education" required>
                            <option value="">-- اختر --</option>
                            <option value="طالب في المدرسة الثانوية">طالب في المدرسة الثانوية</option>
                            <option value="طالب جامعي">طالب جامعي</option>
                            <option value="حاصل على دبلوم">حاصل على دبلوم</option>
                            <option value="حاصل على بكالوريوس">حاصل على بكالوريوس</option>
                            <option value="حاصل على دراسات عليا">حاصل على دراسات عليا</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="field"><i class="fas fa-briefcase"></i> طبيعة العمل/الدراسة:</label>
                        <select id="field" name="field" required>
                            <option value="">-- اختر --</option>
                            <option value="مجال علمي أو طبي">مجال علمي أو طبي</option>
                            <option value="مجال أدبي أو إنساني">مجال أدبي أو إنساني</option>
                            <option value="مجال فني أو إبداعي">مجال فني أو إبداعي</option>
                            <option value="أخرى">أخرى</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="name"><i class="fas fa-user"></i> الاسم (اختياري):</label>
                        <input type="text" id="name" name="name" placeholder="يمكنك ترك هذا الحقل فارغاً إذا كنت تفضل عدم ذكر اسمك">
                    </div>
                    
                    <div class="form-group">
                        <label for="email"><i class="fas fa-envelope"></i> البريد الإلكتروني (اختياري):</label>
                        <input type="email" id="email" name="email" placeholder="example@gmail.com">
                        <small>سيتم استخدام البريد الإلكتروني لإرسال نتائج الاستبيان (اختياري)</small>
                    </div>
                </form>
            </div>
            
            <div class="navigation">
                <button class="btn btn-outline" onclick="showPage('startPage')">
                    <i class="fas fa-arrow-right"></i> العودة
                </button>
                <button class="btn" onclick="saveBasicInfo()">
                    <i class="fas fa-arrow-left"></i> التالي
                </button>
            </div>
        </div>

        <!-- صفحة الاستبيان -->
        <div id="surveyPage" class="page">
            <div class="progress-container">
                <div class="progress-bar" id="progress"></div>
            </div>
            <p class="progress-text" id="progressText">القسم 1 من 5</p>
            
            <div class="survey-sections">
                <!-- سيتم تحميل الأقسام ديناميكياً باستخدام JavaScript -->
            </div>
            
            <div class="navigation">
                <button class="btn btn-outline" id="prevBtn" style="display:none;">
                    <i class="fas fa-arrow-right"></i> السابق
                </button>
                <button class="btn" id="nextBtn">
                    <i class="fas fa-arrow-left"></i> التالي
                </button>
                <button class="btn btn-accent" id="submitBtn" style="display:none;">
                    <i class="fas fa-paper-plane"></i> إرسال الاستبيان
                </button>
            </div>
        </div>

        <!-- صفحة الشكر -->
        <div id="thankYouPage" class="page">
            <div class="welcome-section">
                <div class="welcome-icon">
                    <i class="fas fa-check-circle" style="color: #4caf50;"></i>
                </div>
                <h2>شكراً لك على المشاركة!</h2>
                <p class="welcome-text">
                    شكرًا جزيلًا لك على وقتك! إجاباتك ستساعدنا كثيرًا في فهم أنماط التفكير المختلفة.
                </p>
                
                <div class="card">
                    <p>سيتم إرسال النتائج عبر البريد الإلكتروني! 🧟‍♂️🧠</p>
                </div>
                
                <button class="btn" onclick="showPage('startPage')">
                    <i class="fas fa-home"></i> العودة إلى الصفحة الرئيسية
                </button>
            </div>
        </div>

        <!-- صفحة تسجيل دخول المسؤول -->
        <div id="adminLoginPage" class="page">
            <h2>لوحة إدارة الاستبيان</h2>
            
            <div class="card login-form">
                <h3>تسجيل الدخول</h3>
                <div class="form-group">
                    <label for="adminEmail">البريد الإلكتروني:</label>
                    <input type="email" id="adminEmail" required>
                </div>
                <div class="form-group">
                    <label for="adminPassword">كلمة المرور:</label>
                    <input type="password" id="adminPassword" required>
                </div>
                <button class="btn" onclick="adminLogin()">
                    <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
                </button>
                <p id="loginMessage" style="text-align: center; margin-top: 15px;"></p>
            </div>
            
            <div class="navigation">
                <button class="btn btn-outline" onclick="showPage('startPage')">
                    <i class="fas fa-arrow-right"></i> العودة للرئيسية
                </button>
            </div>
        </div>

        <!-- صفحة إدارة البيانات -->
        <div id="adminPanel" class="page">
            <h2>لوحة إدارة الاستبيان</h2>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-label">إجمالي التسجيلات</div>
                    <div class="stat-value" id="totalRecords">0</div>
                    <div class="stat-label">عدد المشاركين</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">معدل الإكمال</div>
                    <div class="stat-value" id="completionRate">0%</div>
                    <div class="stat-label">نسبة من أكملوا الاستبيان</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">الإناث / الذكور</div>
                    <div class="stat-value" id="genderRatio">0 / 0</div>
                    <div class="stat-label">توزيع الجنسين</div>
                </div>
            </div>
            
            <div class="card">
                <h3>إدارة البيانات</h3>
                <button class="btn" onclick="exportData()">
                    <i class="fas fa-download"></i> تصدير البيانات
                </button>
                <button class="btn btn-accent" onclick="clearData()">
                    <i class="fas fa-trash"></i> حذف جميع البيانات
                </button>
                <button class="btn btn-outline" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                </button>
            </div>
            
            <div class="card">
                <h3>البيانات المجمعة</h3>
                <div id="dataContainer">
                    <!-- سيتم عرض البيانات هنا -->
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn btn-outline" onclick="showPage('startPage')">
                    <i class="fas fa-arrow-right"></i> العودة للرئيسية
                </button>
            </div>
        </div>
    </div>

    <div class="auto-save-indicator" id="autoSaveIndicator">
        <i class="fas fa-save"></i> تم الحفظ تلقائياً
    </div>

    <script>
        // بيانات الاستبيان
        const surveySections = [
            {
                title: "القسم الثاني: التحكم الذاتي واتخاذ القرار",
                questions: [
                    {
                        id: "q5",
                        text: "أخطط مسبقًا وبشكل مفصل لأهدافي على المديين القصير والطويل.",
                        type: "rating"
                    },
                    {
                        id: "q6",
                        text: "أوجد صعوبة كبيرة في اتخاذ القرارات المصيرية (كاختيار المسار الوظيفي أو شريك الحياة) دون الاستماع إلى آراء الكثير من الأشخاص.",
                        type: "rating"
                    },
                    {
                        id: "q7",
                        text: "أتحمل المسؤولية الكاملة عن نتائج قراراتي، سواء كانت إيجابية أم سلبية.",
                        type: "rating"
                    },
                    {
                        id: "q8",
                        text: "أتردد كثيرًا وأخشى ارتكاب الخطأ عندما أضطر للاختيار بين عدة خيارات.",
                        type: "rating"
                    },
                    {
                        id: "q9",
                        text: "أعتقد أن نجاحي أو فشلي هو نتيجة primarily (في الغالب) لخياراتي وأفعالي الشخصية.",
                        type: "rating"
                    },
                    {
                        id: "q10",
                        text: "ما هو المعيار الأساسي الذي تعتمد عليه بشكل رئيسي عند اتخاذ قرار صعب؟ (مثل: المنطق، المشاعر، نصائح الآخرين، التجارب السابقة)",
                        type: "text"
                    },
                    {
                        id: "q11",
                        text: "صِف بإيجاز أكبر قرار مستقل اتخذته في حياتك. كيف كان شعورك إزاءه بعد ذلك؟",
                        type: "text"
                    }
                ]
            },
            {
                title: "القسم الثالث: التأثر بالمجتمع والمحيط",
                questions: [
                    {
                        id: "q12",
                        text: "أختار مشاهدة الأفلام أو المسلسلات فقط لأنها \"رائجة\" والجميع يتحدث عنها.",
                        type: "rating"
                    },
                    {
                        id: "q13",
                        text: "يمارس الأصدقاء أو المحيط الاجتماعي ضغطًا يؤثر بشكل ملحوظ على خياراتي (في الملابس، أماكن الترفيه، وغيرها).",
                        type: "rating"
                    },
                    {
                        id: "q14",
                        text: "أتابع صيحات الموضة في الملابس والمظهر حتى لو لم تتناسب مع طبيعتي الشخصية أو إمكانياتي المادية.",
                        type: "rating"
                    },
                    {
                        id: "q15",
                        text: "أغيّر رأيي في قضية ما لمجرد أني اكتشفت أن رأيي غير مقبول أو غير شائع في محيطي.",
                        type: "rating"
                    },
                    {
                        id: "q16",
                        text: "ألاحظ أنني أتبنى آراء وأفكار عائلتي أو أصدقائي المقربين دون تمحيص أو تدقيق عميق.",
                        type: "rating"
                    },
                    {
                        id: "q17",
                        text: "ما هو أكبر تأثير إيجابي أو سلبي حدث لك نتيجة \"قيامك بشيء ما لمجرد أن الجميع كانوا يفعلونه\"؟",
                        type: "text"
                    },
                    {
                        id: "q18",
                        text: "هل تشعر أحيانًا أنك تعيش حياة مرسومة مسبقًا وفقًا لتوقعات المجتمع منك؟ وضّح.",
                        type: "text"
                    }
                ]
            },
            {
                title: "القسم الرابع: التأثر بالإعلام والمؤثرين",
                questions: [
                    {
                        id: "q19",
                        text: "اشتريت منتجًا مرة واحدة على الأقل فقط لأنني رأيت إعلانًا أو منشورًا عنه على منصات مثل إنستغرام أو تيك توك.",
                        type: "rating"
                    },
                    {
                        id: "q20",
                        text: "أتابع \"المؤثرين\" أو المشاهير على وسائل التواصل وأحاول تقليد أسلوب حياتهم أو آرائهم أو حتى طريقة كلامهم.",
                        type: "rating"
                    },
                    {
                        id: "q21",
                        text: "أثق بشكل كبير في المعلومات والمصادر التي تنتشر على منصات التواصل الاجتماعي.",
                        type: "rating"
                    },
                    {
                        id: "q22",
                        text: "تؤثر عليّ التعليقات والتقييمات على الإنترنت تأثيرًا كبيرًا في تقييمي لأي منتج أو خدمة أو حتى فكرة.",
                        type: "rating"
                    },
                    {
                        id: "q23",
                        text: "أشعر أن حياتي الطبيعية \"عادية\" أو \"mملة\" مقارنة بالحياة التي يعرضها المشاهير والمؤثرون على وسائل التواصل.",
                        type: "rating"
                    },
                    {
                        id: "q24",
                        text: "من هو المؤثر (على يوتيوب، إنستغرام، إلخ) الذي غيّر رأيك أو نظرتك لموضوع مهم؟ كيف حدث ذلك؟",
                        type: "text"
                    },
                    {
                        id: "q25",
                        text: "برأيك، ما هي أكثر الأساليب أو الحيل التي يستخدمها الإعلام أو المسوقون للتأثير على مشترياتك أو آرائك؟",
                        type: "text"
                    }
                ]
            },
            {
                title: "القسم الخامس: الوعي النقدي والتفكير المستقل",
                questions: [
                    {
                        id: "q26",
                        text: "عندما أرى خبرًا مثيرًا أو صادمًا، فإن رد فعلي الأول هو البحث عن مصدر آخر أو رأي مغاير قبل مشاركته أو تصديقه.",
                        type: "rating"
                    },
                    {
                        id: "q27",
                        text: "أستطيع التمييز بسهولة بين الرأي الشخصي والحقيقة الموضوعية في أي منشور أقرأه.",
                        type: "rating"
                    },
                    {
                        id: "q28",
                        text: "أشكك وأتساءل عن الأفكار الشائعة والسائدة، حتى لو كانت مقبولة من الجميع حولي.",
                        type: "rating"
                    },
                    {
                        id: "q29",
                        text: "أتقبل النقد البناء الموجه لي وأستخدمه في تطوير نفسي دون أن تهتز ثقتي بنفسي.",
                        type: "rating"
                    },
                    {
                        id: "q30",
                        text: "أعتقد أن من واجبي أن يكون لي رأيي المستقل في القضايا المهمة، حتى لو كان مختلفًا عن الآخرين.",
                        type: "rating"
                    },
                    {
                        id: "q31",
                        text: "في رأيك، ما هي أقوى وسيلة يمكن للفرد من خلالها حماية استقلاليته وفكره من التأثيرات الخارجية؟",
                        type: "text"
                    },
                    {
                        id: "q32",
                        text: "هل لديك استراتيجية شخصية لتنمية وعيك النقدي؟ (مثل: قراءة مصادر متنوعة، إلخ)",
                        type: "text"
                    }
                ]
            }
        ];

        let currentSection = 0;
        let surveyData = {};
        let autoSaveInterval;

        // وظيفة للتبديل بين الصفحات
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // إذا كانت صفحة الإدارة، تحميل البيانات
            if (pageId === 'adminPanel') {
                loadSurveyData();
                updateAdminStats();
            }
            
            // إذا كانت صفحة الاستبيان، تحميل القسم الحالي
            if (pageId === 'surveyPage') {
                loadCurrentSection();
                startAutoSave();
            } else {
                stopAutoSave();
            }
        }

        // بدء الحفظ التلقائي
        function startAutoSave() {
            // إذا كان هناك فترة حفظ تلقائي قائمة، أوقفها أولاً
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
            }
            
            // بدء فترة جديدة للحفظ التلقائي كل 30 ثانية
            autoSaveInterval = setInterval(() => {
                saveAnswers();
                showAutoSaveIndicator();
            }, 30000);
        }

        // إيقاف الحفظ التلقائي
        function stopAutoSave() {
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
                autoSaveInterval = null;
            }
        }

        // عرض مؤشر الحفظ التلقائي
        function showAutoSaveIndicator() {
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.style.display = 'block';
            
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 2000);
        }

        // حفظ الإجابات تلقائياً
        function saveAnswers() {
            const form = document.querySelector('.survey-section');
            if (!form) return;
            
            const inputs = form.querySelectorAll('input, textarea');
            const sectionAnswers = {};
            
            inputs.forEach(input => {
                if (input.type === 'radio' && input.checked) {
                    sectionAnswers[input.name] = input.value;
                } else if (input.type === 'textarea') {
                    sectionAnswers[input.name] = input.value.trim();
                }
            });
            
            // حفظ إجابات القسم الحالي
            const currentData = JSON.parse(localStorage.getItem('currentSurvey') || '{}');
            currentData.answers = {...currentData.answers, ...sectionAnswers};
            localStorage.setItem('currentSurvey', JSON.stringify(currentData));
        }

        // حفظ المعلومات الأساسية
        function saveBasicInfo() {
            const gender = document.getElementById('gender').value;
            const age = document.getElementById('age').value;
            const education = document.getElementById('education').value;
            const field = document.getElementById('field').value;
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            
            if (!gender || !age || !education || !field) {
                alert('يرجى ملء جميع الحقول الإلزامية');
                return;
            }
            
            surveyData = {
                basicInfo: {
                    gender,
                    age,
                    education,
                    field,
                    name: name || 'مجهول',
                    email: email || ''
                },
                answers: {},
                submittedAt: new Date().toISOString()
            };
            
            // حفظ البيانات مؤقتاً
            localStorage.setItem('currentSurvey', JSON.stringify(surveyData));
            
            // الانتقال إلى صفحة الاستبيان
            showPage('surveyPage');
        }

        // تحميل قسم الاستبيان الحالي
        function loadCurrentSection() {
            if (currentSection >= surveySections.length) {
                submitSurvey();
                return;
            }
            
            const section = surveySections[currentSection];
            const container = document.querySelector('.survey-sections');
            
            // تحديث شريط التقدم
            const progressPercent = ((currentSection + 1) / surveySections.length) * 100;
            document.getElementById('progress').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `القسم ${currentSection + 1} من ${surveySections.length}`;
            
            // إنشاء واجهة القسم الحالي
            let sectionHTML = `<div class="survey-section">
                <h2>${section.title}</h2>`;
            
            section.questions.forEach((question, index) => {
                sectionHTML += `<div class="question">
                    <p class="question-text">${index + 1}. ${question.text}</p>`;
                
                if (question.type === 'rating') {
                    sectionHTML += `<div class="rating">
                        <label>
                            <input type="radio" name="${question.id}" value="1" required>
                            <span>1</span>
                            <span>أوافق بشدة</span>
                        </label>
                        <label>
                            <input type="radio" name="${question.id}" value="2">
                            <span>2</span>
                            <span>أوافق</span>
                        </label>
                        <label>
                            <input type="radio" name="${question.id}" value="3">
                            <span>3</span>
                            <span>محايد</span>
                        </label>
                        <label>
                            <input type="radio" name="${question.id}" value="4">
                            <span>4</span>
                            <span>لا أوافق</span>
                        </label>
                        <label>
                            <input type="radio" name="${question.id}" value="5">
                            <span>5</span>
                            <span>لا أوافق بشدة</span>
                        </label>
                    </div>`;
                } else {
                    sectionHTML += `<textarea name="${question.id}" placeholder="اكتب إجابتك هنا..." required></textarea>`;
                }
                
                sectionHTML += `</div>`;
            });
            
            sectionHTML += `</div>`;
            container.innerHTML = sectionHTML;
            
            // تحميل الإجابات المحفوظة مسبقاً لهذا القسم
            loadSavedAnswers();
            
            // تحديث أزرار التنقل
            document.getElementById('prevBtn').style.display = currentSection > 0 ? 'block' : 'none';
            document.getElementById('nextBtn').style.display = 'block';
            document.getElementById('submitBtn').style.display = currentSection === surveySections.length - 1 ? 'block' : 'none';
            
            // إضافة معالجي الأحداث للأزرار
            document.getElementById('prevBtn').onclick = prevSection;
            document.getElementById('nextBtn').onclick = nextSection;
            document.getElementById('submitBtn').onclick = nextSection;
            
            // إضافة事件 الاستماع للحفظ التلقائي عند التغيير
            const inputs = container.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('change', () => {
                    saveAnswers();
                    showAutoSaveIndicator();
                });
            });
        }

        // تحميل الإجابات المحفوظة
        function loadSavedAnswers() {
            const currentData = JSON.parse(localStorage.getItem('currentSurvey') || '{}');
            if (!currentData.answers) return;
            
            for (const [key, value] of Object.entries(currentData.answers)) {
                // للإجابات النصية
                const textarea = document.querySelector(`textarea[name="${key}"]`);
                if (textarea) {
                    textarea.value = value;
                    continue;
                }
                
                // للإجابات ذات الاختيار المتعدد
                const radio = document.querySelector(`input[name="${key}"][value="${value}"]`);
                if (radio) {
                    radio.checked = true;
                }
            }
        }

        // الانتقال إلى القسم التالي
        function nextSection() {
            // جمع إجابات القسم الحالي
            const form = document.querySelector('.survey-section');
            const inputs = form.querySelectorAll('input, textarea');
            
            let allAnswered = true;
            const sectionAnswers = {};
            
            inputs.forEach(input => {
                if (input.type === 'radio') {
                    if (input.checked) {
                        sectionAnswers[input.name] = input.value;
                    }
                } else if (input.type === 'textarea') {
                    if (!input.value.trim()) {
                        allAnswered = false;
                        input.style.borderColor = 'red';
                    } else {
                        input.style.borderColor = '';
                        sectionAnswers[input.name] = input.value.trim();
                    }
                }
            });
            
            // التحقق من أن جميع الأسئلة قد تمت الإجابة عليها
            const radioGroups = {};
            inputs.forEach(input => {
                if (input.type === 'radio') {
                    if (!radioGroups[input.name]) {
                        radioGroups[input.name] = false;
                    }
                    if (input.checked) {
                        radioGroups[input.name] = true;
                    }
                }
            });
            
            for (const group in radioGroups) {
                if (!radioGroups[group]) {
                    allAnswered = false;
                    alert('يرجى الإجابة على جميع الأسئلة قبل المتابعة');
                    return;
                }
            }
            
            if (!allAnswered) {
                alert('يرجى الإجابة على جميع الأسئلة قبل المتابعة');
                return;
            }
            
            // حفظ إجابات القسم الحالي
            const currentData = JSON.parse(localStorage.getItem('currentSurvey') || '{}');
            currentData.answers = {...currentData.answers, ...sectionAnswers};
            localStorage.setItem('currentSurvey', JSON.stringify(currentData));
            
            // الانتقال إلى القسم التالي
            currentSection++;
            loadCurrentSection();
        }

        // الانتقال إلى القسم السابق
        function prevSection() {
            // حفظ إجابات القسم الحالي أولاً
            saveAnswers();
            
            // ثم الانتقال للقسم السابق
            currentSection--;
            loadCurrentSection();
        }

        // إرسال الاستبيان
        function submitSurvey() {
            const currentData = JSON.parse(localStorage.getItem('currentSurvey') || '{}');
            
            // الحصول على جميع الإجابات المخزنة
            const allResponses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            allResponses.push(currentData);
            
            // حفظ البيانات
            localStorage.setItem('surveyResponses', JSON.stringify(allResponses));
            localStorage.removeItem('currentSurvey');
            
            // إيقاف الحفظ التلقائي
            stopAutoSave();
            
            // الانتقال إلى صفحة الشكر
            showPage('thankYouPage');
        }

        // تسجيل دخول المسؤول
        function adminLogin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            if (email === 'Abdullah.hossam2022@feps.edu.eg' && password === 'admin123') {
                showPage('adminPanel');
            } else {
                document.getElementById('loginMessage').textContent = 'البريد الإلكتروني أو كلمة المرور غير صحيحة';
                document.getElementById('loginMessage').style.color = 'red';
            }
        }

        // تسجيل خروج المسؤول
        function adminLogout() {
            document.getElementById('adminEmail').value = '';
            document.getElementById('adminPassword').value = '';
            document.getElementById('loginMessage').textContent = '';
            showPage('adminLoginPage');
        }

        // تحديث إحصائيات المسؤول
        function updateAdminStats() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            
            // تحديث إجمالي التسجيلات
            document.getElementById('totalRecords').textContent = responses.length;
            
            // تحديث نسبة الجنسين
            let males = 0;
            let females = 0;
            
            responses.forEach(response => {
                if (response.basicInfo.gender === 'ذكر') {
                    males++;
                } else if (response.basicInfo.gender === 'أنثى') {
                    females++;
                }
            });
            
            document.getElementById('genderRatio').textContent = `${females} / ${males}`;
            
            // تحديث معدل الإكمال (نفترض أن جميع المسجلين أكملوا الاستبيان)
            document.getElementById('completionRate').textContent = responses.length > 0 ? '100%' : '0%';
        }

        // تحميل بيانات الاستبيان
        function loadSurveyData() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            const container = document.getElementById('dataContainer');
            
            if (responses.length === 0) {
                container.innerHTML = '<p>لا توجد بيانات حتى الآن</p>';
                return;
            }
            
            let html = '';
            
            responses.forEach((response, index) => {
                html += `<div class="response-item">
                    <div class="response-header">
                        <div class="response-title">المشارك ${index + 1}: ${response.basicInfo.name}</div>
                        <span class="details-toggle" onclick="viewResponseDetails(${index})">عرض التفاصيل</span>
                    </div>
                    <div class="response-details">
                        <p><strong>الجنس:</strong> ${response.basicInfo.gender}</p>
                        <p><strong>الفئة العمرية:</strong> ${response.basicInfo.age}</p>
                        <p><strong>المستوى التعليمي:</strong> ${response.basicInfo.education}</p>
                        <p><strong>مجال العمل/الدراسة:</strong> ${response.basicInfo.field}</p>
                        <p><strong>البريد الإلكتروني:</strong> ${response.basicInfo.email || 'لم يتم提供'}</p>
                        <p><strong>تاريخ المشاركة:</strong> ${new Date(response.submittedAt).toLocaleString('ar-SA')}</p>
                    </div>
                    <div id="details-${index}" style="display:none; margin-top:15px; padding-top:15px; border-top:1px dashed #ddd;">
                        <h4>الإجابات:</h4>`;
                
                for (const [key, value] of Object.entries(response.answers)) {
                    html += `<p><strong>${key}:</strong> ${value}</p>`;
                }
                
                html += `</div></div>`;
            });
            
            container.innerHTML = html;
        }

        // عرض تفاصيل إجابة محددة
        function viewResponseDetails(index) {
            const detailsDiv = document.getElementById(`details-${index}`);
            if (detailsDiv.style.display === 'none') {
                detailsDiv.style.display = 'block';
            } else {
                detailsDiv.style.display = 'none';
            }
        }

        // تصدير البيانات
        function exportData() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            const dataStr = JSON.stringify(responses, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'survey_data.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // حذف جميع البيانات
        function clearData() {
            if (confirm('هل أنت متأكد من أنك تريد حذف جميع البيانات؟ لا يمكن التراجع عن هذا الإجراء.')) {
                localStorage.removeItem('surveyResponses');
                loadSurveyData();
                updateAdminStats();
                alert('تم حذف جميع البيانات بنجاح');
            }
        }

        // استعادة البيانات عند تحميل الصفحة
        window.addEventListener('load', function() {
            // تحميل البيانات المحفوظة إذا كانت موجودة
            const savedData = localStorage.getItem('currentSurvey');
            if (savedData) {
                surveyData = JSON.parse(savedData);
                
                // إذا كان هناك بيانات محفوظة، انتقل مباشرة إلى صفحة الاستبيان
                if (surveyData.basicInfo) {
                    showPage('surveyPage');
                }
            }
        });
    </script>
</body>
  </html>
